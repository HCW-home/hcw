<ion-content class="login-content" [scrollY]="false">
  <div class="auth-card">
    <div class="left-side">
      <div class="left-content">
        @if (siteLogoWhite) {
        <img [src]="siteLogoWhite" alt="Logo" class="logo-img" />
        } @else {
        <img src="assets/images/logo.svg" alt="Logo" class="logo-img" />
        }
        <h1>{{ branding }}</h1>
        <p>{{ 'resetPassword.subtitle' | translate }}</p>
      </div>
    </div>
    <div class="right-side">
      <div class="right-content">
        <h2>{{ 'resetPassword.title' | translate }}</h2>
        <p class="subtitle">{{ 'resetPassword.subtitle' | translate }}</p>

        @if (errorMessage && (!uid || !token)) {
        <div class="error-state">
          <ion-icon name="alert-circle-outline" color="danger" class="error-icon"></ion-icon>
          <ion-text color="danger">{{ errorMessage }}</ion-text>
          <ion-button
            expand="block"
            shape="round"
            (click)="goToForgotPassword()"
            class="login-button"
            style="margin-top: 16px;">
            {{ 'resetPassword.requestNewLink' | translate }}
          </ion-button>
        </div>
        } @else {
        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="login-form">
          <ion-item lines="full" class="input-item">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              [type]="showPassword ? 'text' : 'password'"
              [placeholder]="'resetPassword.newPassword' | translate"
              formControlName="password">
            </ion-input>
            <ion-icon
              [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
              slot="end"
              (click)="togglePasswordVisibility()"
              class="password-toggle">
            </ion-icon>
          </ion-item>
          @if (resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched) {
          <ion-text color="danger" class="error-message">
            <span class="error-text">{{ 'resetPassword.passwordMinLength' | translate }}</span>
          </ion-text>
          }

          <ion-item lines="full" class="input-item">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            <ion-input
              [type]="showConfirmPassword ? 'text' : 'password'"
              [placeholder]="'resetPassword.confirmNewPassword' | translate"
              formControlName="confirmPassword">
            </ion-input>
            <ion-icon
              [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"
              slot="end"
              (click)="toggleConfirmPasswordVisibility()"
              class="password-toggle">
            </ion-icon>
          </ion-item>
          @if (resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched) {
          <ion-text color="danger" class="error-message">
            <span class="error-text">{{ 'resetPassword.confirmRequired' | translate }}</span>
          </ion-text>
          }

          @if (errorMessage && uid && token) {
          <ion-text color="danger" class="error-message">
            <span class="error-text">{{ errorMessage }}</span>
          </ion-text>
          }

          <ion-button
            expand="block"
            shape="round"
            type="submit"
            [disabled]="resetPasswordForm.invalid || isLoading"
            class="login-button">
            @if (isLoading) {
              <ion-spinner name="crescent"></ion-spinner>
              {{ 'resetPassword.resetting' | translate }}
            } @else {
              {{ 'resetPassword.title' | translate }}
            }
          </ion-button>
        </form>
        }

        <div class="register-link">
          <ion-text class="register-text" color="medium">
            {{ 'resetPassword.rememberPassword' | translate }}
          </ion-text>
          <ion-text color="primary" (click)="goToLogin()" class="link-text">
            {{ 'common.signIn' | translate }}
          </ion-text>
        </div>
      </div>
    </div>
  </div>
</ion-content>
