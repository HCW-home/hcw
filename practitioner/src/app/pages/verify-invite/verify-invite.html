<div class="verify-page">
  <div class="verify-container">

    @if (isLoading) {
      <div class="loading-state">
        <app-loader></app-loader>
        <app-typography
          [variant]="TypographyTypeEnum['body-medium']"
          color="var(--slate-500)">
          @if (requiresVerification) {
            {{ 'verifyInvite.verifyingCode' | translate }}
          } @else {
            {{ 'verifyInvite.authenticating' | translate }}
          }
        </app-typography>
      </div>
    } @else if (errorMessage) {
      <div class="error-state">
        <app-svg
          src="error"
          [svgStyle]="{ 'width.px': 48, 'height.px': 48, color: 'var(--error-500)' }">
        </app-svg>
        <app-typography
          [variant]="TypographyTypeEnum['h6-semibold']"
          color="var(--error-600)">
          {{ 'verifyInvite.authFailed' | translate }}
        </app-typography>
        <app-typography
          [variant]="TypographyTypeEnum['body-regular']"
          color="var(--slate-500)">
          {{ errorMessage }}
        </app-typography>
        <app-button
          [block]="true"
          [style]="ButtonStyleEnum.primary"
          [text]="'verifyInvite.goToLogin' | translate"
          (buttonClick)="goToLogin()">
        </app-button>
      </div>
    } @else if (requiresVerification) {
      <div class="verification-state">
        <app-svg
          src="shield-check"
          [svgStyle]="{ 'width.px': 48, 'height.px': 48, color: 'var(--primary-600)' }">
        </app-svg>
        <app-typography
          [variant]="TypographyTypeEnum['h6-semibold']"
          color="var(--slate-800)">
          {{ 'verifyInvite.verificationRequired' | translate }}
        </app-typography>
        <app-typography
          [variant]="TypographyTypeEnum['body-regular']"
          color="var(--slate-500)">
          {{ 'verifyInvite.codeSentMessage' | translate }}
        </app-typography>

        <form [formGroup]="verificationForm" (ngSubmit)="submitVerificationCode()" class="verification-form">
          <app-input
            [label]="'verifyInvite.verificationCode' | translate"
            name="verification_code"
            [placeholder]="'verifyInvite.codePlaceholder' | translate"
            formControlName="verification_code"
            [invalid]="!!(verificationForm.get('verification_code')?.invalid && verificationForm.get('verification_code')?.touched)"
            [invalidMessage]="'verifyInvite.invalidCode' | translate">
          </app-input>

          @if (errorMessage) {
            <app-error-message [message]="errorMessage"></app-error-message>
          }

          <app-button
            [block]="true"
            [type]="ButtonTypeEnum.submit"
            [style]="ButtonStyleEnum.primary"
            [text]="'verifyInvite.verifyCode' | translate"
            [disabled]="verificationForm.invalid"
            [loading]="loadingButton">
          </app-button>
        </form>

        <div class="resend-code">
          <app-typography
            [variant]="TypographyTypeEnum['body-s-regular']"
            color="var(--slate-500)">
            {{ 'verifyInvite.didntReceive' | translate }}
          </app-typography>
          <span
            class="resend-link"
            [class.disabled]="isResending"
            (click)="resendVerificationCode()">
            @if (isResending) {
              {{ 'verifyInvite.sending' | translate }}
            } @else {
              {{ 'verifyInvite.resendCode' | translate }}
            }
          </span>
        </div>

        <div class="login-link">
          <app-typography
            [variant]="TypographyTypeEnum['body-s-regular']"
            color="var(--slate-500)">
            {{ 'verifyInvite.havingTrouble' | translate }}
          </app-typography>
          <span class="action-link" (click)="goToLogin()">{{ 'verifyInvite.signInManually' | translate }}</span>
        </div>
      </div>
    }
  </div>
</div>
